<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
  xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>WBC2026 Round Robin</title>

<style>
body {
  font-family: "Segoe UI", "Helvetica Neue", Arial, sans-serif;
  background: #f7f7f7;
}

.wrapper {
  max-width: 1200px;
  margin: 40px auto;
}

/* ===== ã‚¿ãƒ– ===== */
.pool-tabs {
  display: flex;
  justify-content: center;
  margin-bottom: 20px;
}

.pool-tabs button {
  padding: 8px 16px;
  border: 1px solid #333;
  background: #fff;
  cursor: pointer;
  font-weight: 700;
}

.pool-tabs button.active {
  background: #000;
  color: #fff;
}

/* ===== POOLè¡¨ç¤ºåˆ¶å¾¡ ===== */
.pool-panel { display: none; }
.pool-panel.active { display: block; }

/* ===== ãƒ†ãƒ¼ãƒ–ãƒ« ===== */
.round-robin-table {
  width: 100%;
  border-collapse: collapse;
  background: #fff;
  table-layout: fixed;
}

.round-robin-table th,
.round-robin-table td {
  border: 1.5px solid #000;
  text-align: center;
  padding: 6px;
  font-size: 14px;
}

.round-robin-table th {
  background: #eee;
  font-weight: 700;
}

.team-name {
  text-align: left;
  padding-left: 8px;
  font-weight: 700;
  background: #fafafa;
}

.no-game { background: #ddd; }
.win { font-weight: 800; }
.lose { opacity: 0.6; }

.rank-col {
  background: #f2f2f2;
  font-weight: 700;
}

/* ===============================
   æˆ»ã‚‹ãƒœã‚¿ãƒ³
================================ */
.back-area {
  margin: 40px auto 60px;
  text-align: center;
}

.back-button {
    display: inline-block;
    padding: 32px 48px;
    background: #fb0000;
    color: #fff;
    font-weight: bold;
    text-decoration: none;
    border-radius: 6px;
    transition: opacity 0.2s ease;
}

.back-button:hover {
  opacity: 0.8;
}


</style>
</head>

<body>
<div class="wrapper">

<!-- ===== ã‚¿ãƒ– ===== -->
<div class="pool-tabs">
  <button class="active" data-target="poolA">POOL A</button>
  <button data-target="poolB">POOL B</button>
  <button data-target="poolC">POOL C</button>
  <button data-target="poolD">POOL D</button>
</div>

<!-- ================= POOL A ================= -->
<div id="poolA" class="pool-panel active">
<h2>POOL A</h2>
<table class="round-robin-table">
<tr>
  <th></th>
  <th>PUR</th><th>CUB</th><th>CAN</th><th>PAN</th><th>COL</th>
  <th class="rank-col">å‹</th>
  <th class="rank-col">æ•—</th>
  <th class="rank-col">å¾—å¤±</th>
  <th class="rank-col">é †ä½</th>
</tr>

<tr>
  <th class="team-name">ğŸ‡µğŸ‡· ãƒ—ã‚¨ãƒ«ãƒˆãƒªã‚³</th>
  <td class="no-game">â€”</td><td>â—¯<br>6-3</td><td>â—¯<br>5-2</td><td>â—<br>2-4</td><td>â—¯<br>7-1</td>
  <td class="rank-col win-count"></td>
  <td class="rank-col lose-count"></td>
  <td class="rank-col run-diff"></td>
  <td class="rank-col rank"></td>
</tr>

<tr>
  <th class="team-name">ğŸ‡¨ğŸ‡º ã‚­ãƒ¥ãƒ¼ãƒ</th>
  <td>â—<br>3-6</td><td class="no-game">â€”</td><td>â—¯<br>4-2</td><td>â—¯<br>6-5</td><td>â—¯<br>8-1</td>
  <td class="rank-col win-count"></td>
  <td class="rank-col lose-count"></td>
  <td class="rank-col run-diff"></td>
  <td class="rank-col rank"></td>
</tr>

<tr>
  <th class="team-name">ğŸ‡¨ğŸ‡¦ ã‚«ãƒŠãƒ€</th>
  <td>â—<br>2-5</td><td>â—<br>2-4</td><td class="no-game">â€”</td><td>â—¯<br>5-3</td><td>â—¯<br>6-4</td>
  <td class="rank-col win-count"></td>
  <td class="rank-col lose-count"></td>
  <td class="rank-col run-diff"></td>
  <td class="rank-col rank"></td>
</tr>

<tr>
  <th class="team-name">ğŸ‡µğŸ‡¦ ãƒ‘ãƒŠãƒ</th>
  <td>â—¯<br>4-2</td><td>â—<br>5-6</td><td>â—<br>3-5</td><td class="no-game">â€”</td><td>â—¯<br>6-3</td>
  <td class="rank-col win-count"></td>
  <td class="rank-col lose-count"></td>
  <td class="rank-col run-diff"></td>
  <td class="rank-col rank"></td>
</tr>

<tr>
  <th class="team-name">ğŸ‡¨ğŸ‡´ ã‚³ãƒ­ãƒ³ãƒ“ã‚¢</th>
  <td>â—<br>1-7</td><td>â—<br>1-8</td><td>â—<br>4-6</td><td>â—<br>3-6</td><td class="no-game">â€”</td>
  <td class="rank-col win-count"></td>
  <td class="rank-col lose-count"></td>
  <td class="rank-col run-diff"></td>
  <td class="rank-col rank"></td>
</tr>
</table>
</div>

<!-- ================= POOL B ================= -->
<div id="poolB" class="pool-panel">
<h2>POOL B</h2>
<table class="round-robin-table">
<tr>
  <th></th>
  <th>USA</th><th>MEX</th><th>CAN</th><th>COL</th><th>GBR</th>
  <th class="rank-col">å‹</th>
  <th class="rank-col">æ•—</th>
  <th class="rank-col">å¾—å¤±</th>
  <th class="rank-col">é †ä½</th>
</tr>

<tr>
  <th class="team-name">ğŸ‡ºğŸ‡¸ ã‚¢ãƒ¡ãƒªã‚«</th>
  <td class="no-game">â€”</td><td>â—¯<br>5-3</td><td>â—¯<br>6-2</td><td>â—¯<br>7-4</td><td>â—¯<br>9-1</td>
  <td class="rank-col win-count"></td>
  <td class="rank-col lose-count"></td>
  <td class="rank-col run-diff"></td>
  <td class="rank-col rank"></td>
</tr>

<tr>
  <th class="team-name">ğŸ‡²ğŸ‡½ ãƒ¡ã‚­ã‚·ã‚³</th>
  <td>â—<br>3-5</td><td class="no-game">â€”</td><td>â—¯<br>4-2</td><td>â—¯<br>6-5</td><td>â—¯<br>8-2</td>
  <td class="rank-col win-count"></td>
  <td class="rank-col lose-count"></td>
  <td class="rank-col run-diff"></td>
  <td class="rank-col rank"></td>
</tr>

<tr>
  <th class="team-name">ğŸ‡¨ğŸ‡¦ ã‚«ãƒŠãƒ€</th>
  <td>â—<br>2-6</td><td>â—<br>2-4</td><td class="no-game">â€”</td><td>â—¯<br>5-3</td><td>â—¯<br>6-4</td>
  <td class="rank-col win-count"></td>
  <td class="rank-col lose-count"></td>
  <td class="rank-col run-diff"></td>
  <td class="rank-col rank"></td>
</tr>

<tr>
  <th class="team-name">ğŸ‡¨ğŸ‡´ ã‚³ãƒ­ãƒ³ãƒ“ã‚¢</th>
  <td>â—<br>4-7</td><td>â—<br>5-6</td><td>â—<br>3-5</td><td class="no-game">â€”</td><td>â—¯<br>7-2</td>
  <td class="rank-col win-count"></td>
  <td class="rank-col lose-count"></td>
  <td class="rank-col run-diff"></td>
  <td class="rank-col rank"></td>
</tr>

<tr>
  <th class="team-name">ğŸ‡¬ğŸ‡§ ã‚¤ã‚®ãƒªã‚¹</th>
  <td>â—<br>1-9</td><td>â—<br>2-8</td><td>â—<br>4-6</td><td>â—<br>2-7</td><td class="no-game">â€”</td>
  <td class="rank-col win-count"></td>
  <td class="rank-col lose-count"></td>
  <td class="rank-col run-diff"></td>
  <td class="rank-col rank"></td>
</tr>
</table>
</div>

<!-- ================= POOL C ================= -->
<div id="poolC" class="pool-panel active">

  <!-- â˜… å‹•ä½œç¢ºèªç”¨ï¼ˆteams ãŒãƒã‚¤ãƒ³ãƒ‰ã•ã‚Œã¦ã„ã‚Œã° 5 teams ã¨å‡ºã‚‹ï¼‰ -->
  <h2 th:text="'POOL C (' + ${teams.size()} + ' teams)'">POOL C</h2>

  <table class="round-robin-table">
    <tr>
      <th></th>

      <th th:each="away : ${teams}"
          th:text="${away}">TEAM</th>

      <th class="rank-col">å‹</th>
      <th class="rank-col">æ•—</th>
      <th class="rank-col">å¾—å¤±</th>
      <th class="rank-col">é †ä½</th>
    </tr>

    <tr th:each="home : ${teams}">
      <th class="team-name" th:text="${home}">HOME</th>

        <td th:each="away : ${teams}"
            th:with="row=${matrix.get(home)},
                    cell=${row != null ? row.get(away) : null}"
            th:classappend="${cell != null and cell.self} ? 'no-game' : ''">

            <span th:utext="${cell != null ? cell.display : 'â€”'}">â€”</span>

        </td>

       <!-- <td class="rank-col win-count"></td>
        <td class="rank-col lose-count"></td>
        <td class="rank-col run-diff"></td>
        <td class="rank-col rank"></td> -->

<td class="rank-col win-count"
    th:with="stat=${stats.get(home)}"
    th:text="${stat != null ? stat.win : 0}">
    0
</td>

<td class="rank-col lose-count"
    th:with="stat=${stats.get(home)}"
    th:text="${stat != null ? stat.lose : 0}">
    0
</td>

<td class="rank-col run-diff"
    th:with="stat=${stats.get(home)}"
    th:text="${stat != null ? stat.runDiff : 0}">
    0
</td>

<td class="rank-col rank"
    th:with="stat=${stats.get(home)}"
    th:text="${stat != null && stat.rank != null ? stat.rank : '-'}">-</td>


    </tr>
  </table>
</div>

<!-- ================= POOL D ================= -->
<div id="poolD" class="pool-panel">
<h2>POOL D</h2>
<table class="round-robin-table">
<tr>
  <th></th>
  <th>VEN</th><th>DOM</th><th>PUR</th><th>NED</th><th>ISR</th>
  <th class="rank-col">å‹</th>
  <th class="rank-col">æ•—</th>
  <th class="rank-col">å¾—å¤±</th>
  <th class="rank-col">é †ä½</th>
</tr>

<tr>
  <th class="team-name">ğŸ‡»ğŸ‡ª ãƒ™ãƒã‚ºã‚¨ãƒ©</th>
  <td class="no-game">â€”</td><td>â—¯<br>6-4</td><td>â—<br>3-5</td><td>â—¯<br>7-2</td><td>â—¯<br>8-1</td>
  <td class="rank-col win-count"></td>
  <td class="rank-col lose-count"></td>
  <td class="rank-col run-diff"></td>
  <td class="rank-col rank"></td>
</tr>

<tr>
  <th class="team-name">ğŸ‡©ğŸ‡´ ãƒ‰ãƒŸãƒ‹ã‚«å…±å’Œå›½</th>
  <td>â—<br>4-6</td><td class="no-game">â€”</td><td>â—¯<br>6-3</td><td>â—¯<br>5-2</td><td>â—¯<br>9-0</td>
  <td class="rank-col win-count"></td>
  <td class="rank-col lose-count"></td>
  <td class="rank-col run-diff"></td>
  <td class="rank-col rank"></td>
</tr>

<tr>
  <th class="team-name">ğŸ‡µğŸ‡· ãƒ—ã‚¨ãƒ«ãƒˆãƒªã‚³</th>
  <td>â—¯<br>5-3</td><td>â—<br>3-6</td><td class="no-game">â€”</td><td>â—¯<br>4-2</td><td>â—¯<br>6-1</td>
  <td class="rank-col win-count"></td>
  <td class="rank-col lose-count"></td>
  <td class="rank-col run-diff"></td>
  <td class="rank-col rank"></td>
</tr>

<tr>
  <th class="team-name">ğŸ‡³ğŸ‡± ã‚ªãƒ©ãƒ³ãƒ€</th>
  <td>â—<br>2-7</td><td>â—<br>2-5</td><td>â—<br>2-4</td><td class="no-game">â€”</td><td>â—¯<br>5-3</td>
  <td class="rank-col win-count"></td>
  <td class="rank-col lose-count"></td>
  <td class="rank-col run-diff"></td>
  <td class="rank-col rank"></td>
</tr>

<tr>
  <th class="team-name">ğŸ‡®ğŸ‡± ã‚¤ã‚¹ãƒ©ã‚¨ãƒ«</th>
  <td>â—<br>1-8</td><td>â—<br>0-9</td><td>â—<br>1-6</td><td>â—<br>3-5</td><td class="no-game">â€”</td>
  <td class="rank-col win-count"></td>
  <td class="rank-col lose-count"></td>
  <td class="rank-col run-diff"></td>
  <td class="rank-col rank"></td>
</tr>
</table>
</div>

</div>

<div class="back-area">
  <a href="#" id="backToStanding" class="back-button">
    â† POOLé †ä½ä¸€è¦§ã¸æˆ»ã‚‹
  </a>
</div>


<script>
/* ===== ã‚¿ãƒ–åˆ‡æ›¿ ===== */
const tabs = document.querySelectorAll(".pool-tabs button");
const panels = document.querySelectorAll(".pool-panel");

tabs.forEach(btn => {
  btn.onclick = () => {
    tabs.forEach(b => b.classList.remove("active"));
    panels.forEach(p => p.classList.remove("active"));
    btn.classList.add("active");
    document.getElementById(btn.dataset.target).classList.add("active");
  };
});

/* ===== å‹æ•—ãƒ»å¾—å¤±ç‚¹ãƒ»é †ä½ è‡ªå‹•è¨ˆç®— =====
   â€» POOL C ã¯ Thymeleaf æç”»ã®ãŸã‚é™¤å¤–
=========================================== */
document.querySelectorAll(".round-robin-table").forEach(table => {

  // â˜…â˜…â˜… ã“ã“ãŒå”¯ä¸€ã®è¿½åŠ ãƒã‚¤ãƒ³ãƒˆ â˜…â˜…â˜…
  // POOL Cï¼ˆThymeleafæç”»ï¼‰ã¯ JS é›†è¨ˆã—ãªã„
  if (table.closest("#poolC")) {
    return;
  }

  const rows = Array.from(table.querySelectorAll("tr")).slice(1);

  const teams = rows.map(row => {
    const tds = Array.from(row.querySelectorAll("td"));
    let win = 0;
    let lose = 0;
    let scored = 0;
    let allowed = 0;

    tds.forEach(td => {
      const text = td.textContent;

      if (text.includes("â—¯")) win++;
      if (text.includes("â—")) lose++;

      const match = text.match(/(\d+)\s*-\s*(\d+)/);
      if (match) {
        scored += parseInt(match[1], 10);
        allowed += parseInt(match[2], 10);
      }
    });

    const diff = scored - allowed;
    row.querySelector(".win-count").textContent = win;
    row.querySelector(".lose-count").textContent = lose;
    row.querySelector(".run-diff").textContent =
      diff > 0 ? `+${diff}` : diff;

    return { row, win, lose, diff };
  });

  teams
    .sort((a, b) => b.win - a.win || b.diff - a.diff)
    .forEach((t, i) => {
      t.row.querySelector(".rank").textContent = i + 1;
    });
});
</script>

<script>
/*
=====================================
 RoundRobin è©³ç´° â†’ å…ƒç”»é¢ã¸æˆ»ã‚‹åˆ¶å¾¡ï¼ˆä¿®æ­£ç‰ˆï¼‰
=====================================
*/
document.addEventListener("DOMContentLoaded", () => {

  const backBtn = document.getElementById("backToStanding");
  if (!backBtn) return;

  backBtn.addEventListener("click", (e) => {
    e.preventDefault();

    const params = new URLSearchParams(window.location.search);
    const mode = params.get("mode");

    let target = "/WorldBaseballClassic";

    if (mode === "japan" || mode === "all") {
      target += "?mode=" + mode;
    }

    // â˜… hash ã¯å¿…ãšã“ã‚Œã ã‘
    target += "#pool-title";

    window.location.href = target;
  });

});
</script>

</body>
</html>
